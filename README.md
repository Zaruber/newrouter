# VLESS Router для OpenWrt

VLESS Router — это проект для упрощения настройки и управления VLESS прокси на роутерах с OpenWrt. Данное программное обеспечение позволяет легко создавать и управлять WiFi сетями с различными режимами работы (с прокси и без), а также управлять профилями подключения VLESS.

## Возможности

- **Простая установка** с компьютера на роутер через графический интерфейс
- **Полностью веб-интерфейс** для всех настроек, без необходимости использования командной строки
- **Мастер первоначальной настройки** для пошагового подключения роутера к интернету
- Создание **двух WiFi сетей**:
  - Прямая сеть (без прокси)
  - Прокси сеть (весь трафик через VLESS)
- Удобное **управление профилями VLESS**
- **Интуитивно понятный веб-интерфейс** для мониторинга и настройки

## Требования

- Роутер с установленной OpenWrt (рекомендуется версия 21.02 или новее)
- Не менее 4 МБ свободной памяти на роутере
- Для Windows: Git for Windows (для работы SSH/SCP) или другой SSH-клиент
- Для Linux/macOS: Стандартные утилиты SSH/SCP

## Установка

### Самый простой способ (для Windows)

1. **Скачайте** репозиторий:
   - Используйте кнопку "Code" → "Download ZIP" на [GitHub](https://github.com/Zaruber/newrouter)
   - Или клонируйте репозиторий: `git clone https://github.com/Zaruber/newrouter.git`
   - Распакуйте ZIP-архив, если вы скачали его

2. **Запустите установщик** (один из вариантов):
   - **Графический интерфейс**: Откройте файл `vless-router-installer.ps1` (правой кнопкой мыши → "Запустить с помощью PowerShell")
   - **Командная строка**: Запустите `vless-router-installer.bat` из командной строки Windows

3. **Введите данные для подключения**:
   - IP-адрес вашего роутера (обычно 192.168.1.1)
   - Имя пользователя (обычно root)
   - Пароль для SSH-доступа
   - Нажмите "Установить"

4. **Следуйте инструкциям** в открывшемся веб-браузере:
   - Мастер настройки автоматически откроется по адресу http://[IP-роутера]:8080
   - Пройдите все шаги мастера настройки

### Установка для Linux/macOS

#### Автоматический установщик с веб-интерфейсом (рекомендуется)

Этот метод запускает локальный веб-сервер на вашем компьютере, который предоставляет удобный графический интерфейс для установки и настройки VLESS Router.

1. **Скачайте** репозиторий:
   ```bash
   git clone https://github.com/Zaruber/newrouter.git
   cd newrouter
   ```

2. **Запустите веб-установщик**:
   ```bash
   chmod +x vless-router-web-installer.sh
   ./vless-router-web-installer.sh
   ```

3. **Выполните настройку через веб-интерфейс**:
   - Веб-браузер автоматически откроется с адресом установщика
   - Введите данные для подключения к роутеру
   - Следуйте инструкциям в веб-интерфейсе

4. **Завершите настройку на роутере**:
   - После установки автоматически откроется веб-интерфейс роутера
   - Продолжите настройку через веб-интерфейс VLESS Router на роутере

#### Автоматический установщик в командной строке

1. **Скачайте** репозиторий:
   - Используйте кнопку "Code" → "Download ZIP" на [GitHub](https://github.com/Zaruber/newrouter)
   - Или клонируйте репозиторий: `git clone https://github.com/Zaruber/newrouter.git`
   - Распакуйте ZIP-архив, если вы скачали его

2. **Запустите установщик**:
   ```bash
   cd newrouter
   chmod +x vless-router-installer.sh
   ./vless-router-installer.sh
   ```

3. **Введите данные для подключения**:
   - IP-адрес вашего роутера (обычно 192.168.1.1)
   - Порт SSH (обычно 22)
   - Имя пользователя (обычно root)
   - Пароль для SSH-доступа

4. **Следуйте инструкциям** в открывшемся веб-браузере:
   - Мастер настройки автоматически откроется по адресу http://[IP-роутера]:8080
   - Пройдите все шаги мастера настройки

#### Ручная установка через скрипт

Если автоматический установщик не работает, вы можете использовать этот скрипт:

```bash
# Клонируйте репозиторий
git clone https://github.com/Zaruber/newrouter.git
cd newrouter

# Создайте скрипт для ручной установки (install.sh)
cat > install.sh << 'EOF'
#!/bin/bash
ROUTER_IP=${1:-"192.168.1.1"}
SSH_USER=${2:-"root"}
SSH_PORT=${3:-"22"}

# Создание директории на роутере
ssh -p $SSH_PORT $SSH_USER@$ROUTER_IP "mkdir -p /root/vless-router"

# Копирование файлов
scp -r -P $SSH_PORT config scripts web setup_webserver.sh README.md $SSH_USER@$ROUTER_IP:/root/vless-router/

# Настройка веб-сервера
ssh -p $SSH_PORT $SSH_USER@$ROUTER_IP "cd /root/vless-router && chmod +x ./setup_webserver.sh && ./setup_webserver.sh"

echo "Установка завершена! Откройте http://$ROUTER_IP:8080 для настройки"
EOF

# Установка прав и запуск
chmod +x install.sh
./install.sh [IP-роутера] [пользователь] [порт SSH]

# После установки откройте браузер и перейдите по адресу
# http://[IP-роутера]:8080
```

### Ручная установка через SSH

Для опытных пользователей, которые предпочитают ручную установку:

```bash
# Подключитесь к роутеру по SSH
ssh root@192.168.1.1

# Создайте директорию для проекта
mkdir -p /root/vless-router

# Выйдите из SSH и скопируйте файлы на роутер (с локального компьютера)
scp -r path/to/newrouter/{config,scripts,web,setup_webserver.sh,README.md} root@192.168.1.1:/root/vless-router/

# Снова подключитесь к роутеру и запустите настройку
ssh root@192.168.1.1
cd /root/vless-router
chmod +x setup_webserver.sh
./setup_webserver.sh

# После этого откройте браузер и перейдите по адресу
# http://192.168.1.1:8080
```

## Использование

### Первоначальная настройка

После открытия веб-интерфейса вы увидите мастер настройки, который проведет вас через следующие шаги:

1. **Подключение к интернету**:
   - Сканирование доступных WiFi сетей
   - Подключение к вашей домашней WiFi сети

2. **Установка необходимых пакетов**:
   - Автоматическая установка Xray и других компонентов
   - Настройка сетевых параметров

3. **Настройка WiFi сетей**:
   - Создание прямой сети (без прокси)
   - Создание прокси сети (с VLESS)

4. **Настройка профиля VLESS**:
   - Добавление данных для подключения к серверу VLESS
   - Выбор режима работы прокси

### Управление системой

После завершения настройки вы получите доступ к основному интерфейсу с разделами:

- **Панель управления**: просмотр статуса системы, состояния соединений
- **Профили**: управление профилями VLESS
- **Сайты**: настройка проксирования для конкретных сайтов
- **WiFi**: настройка параметров WiFi сетей
- **Настройки**: общие настройки системы

### WiFi сети

После настройки на вашем роутере будут созданы две WiFi сети:

1. **VLESS_DIRECT** - сеть без проксирования трафика
2. **VLESS_PROXY** - сеть с проксированием всего трафика через VLESS

## Устранение неполадок

### Не удается подключиться к веб-интерфейсу

1. **Проверьте подключение к роутеру**:
   - Убедитесь, что ваш компьютер подключен к сети роутера
   - Убедитесь, что роутер включен и работает

2. **Проверьте IP-адрес роутера**:
   - Обычно это 192.168.1.1 или 192.168.0.1
   - Попробуйте перейти по адресу http://192.168.1.1:8080

3. **Перезапустите веб-сервер на роутере**:
   ```bash
   ssh root@192.168.1.1 "/etc/init.d/uhttpd restart"
   ```

### Проблемы при установке на Windows

1. **Ошибки SSH/SCP**:
   - Установите Git for Windows с сайта https://gitforwindows.org/
   - Убедитесь, что команды `ssh` и `scp` доступны в командной строке

2. **Проблемы с паролем**:
   - Если пароль содержит специальные символы, попробуйте изменить его на более простой
   - Временно настройте аутентификацию по ключу SSH

### Проблемы с подключением к интернету

1. **Проверьте настройки WiFi**:
   - Убедитесь, что данные домашней WiFi сети введены правильно
   - Проверьте доступность домашней WiFi сети

2. **Проверьте сигнал WiFi**:
   - Убедитесь, что роутер находится в зоне действия домашней WiFi сети
   - При необходимости переместите роутер ближе к источнику сигнала

## Часто задаваемые вопросы (FAQ)

### Как обновить VLESS Router до новой версии?

Просто запустите установщик заново с актуальной версией проекта. Ваши настройки будут сохранены.

### Можно ли использовать VLESS Router на первичном роутере?

Да, но рекомендуется использовать его на вторичном роутере для большей гибкости в настройке сетей.

### Как сменить пароль WiFi сетей после установки?

В веб-интерфейсе перейдите в раздел "WiFi" и измените настройки для соответствующей сети.

### Как добавить новый профиль VLESS?

В веб-интерфейсе перейдите в раздел "Профили" и нажмите кнопку "Добавить профиль".

### Что делать, если CGI-скрипты не работают?

Проверьте, что на роутере установлен PHP:
```bash
ssh root@192.168.1.1 "opkg update && opkg install php7-cgi"
```

## Вклад в проект

Если вы хотите внести свой вклад в проект, пожалуйста:

1. Сделайте форк репозитория
2. Создайте ветку для вашей функциональности (`git checkout -b feature/amazing-feature`)
3. Зафиксируйте ваши изменения (`git commit -m 'Add some amazing feature'`)
4. Отправьте изменения в ветку (`git push origin feature/amazing-feature`)
5. Откройте Pull Request

## Лицензия

Этот проект распространяется под лицензией MIT. См. файл `LICENSE` для получения дополнительной информации.

## Отказ от ответственности

Данное программное обеспечение предоставляется "как есть", без каких-либо гарантий. Авторы не несут ответственности за любой возможный ущерб, связанный с использованием данного ПО. Используйте на свой страх и риск.

---

© 2023-2024 VLESS Router Project
