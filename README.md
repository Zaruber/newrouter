# VLESS Router для OpenWRT

Простое решение для настройки прокси через VLESS на роутере с OpenWRT. Это руководство поможет настроить роутер CUDY AC1200 (Model: TR1200) или любой другой роутер с OpenWRT для проксирования трафика через VLESS.

## Возможности

- Автоматическая настройка VLESS прокси
- Веб-интерфейс для управления настройками
- Возможность создания двух WiFi сетей: с прокси и без прокси
- Поддержка черного и белого списков сайтов для проксирования
- Несколько профилей VLESS с возможностью переключения
- Простая установка и настройка

## Требования

- Роутер с установленной OpenWRT (тестировалось на CUDY AC1200 TR1200)
- Доступ SSH к роутеру
- Установленный пакет `xray-core` и сопутствующие пакеты

## Установка

### Быстрая установка

1. Подключитесь к роутеру по SSH:
```
ssh root@192.168.1.1
```

2. Установите необходимые пакеты:
```
opkg update
opkg install wget curl xray-core luci-app-xray uhttpd uhttpd-mod-ubus openvpn-openssl luci-app-openvpn
```

3. Скачайте и запустите установочный скрипт:
```
wget -O install.sh https://raw.githubusercontent.com/yourusername/vless-router/main/install.sh
chmod +x install.sh
./install.sh
```

4. После установки веб-интерфейс будет доступен по адресу:
```
http://192.168.1.1:8080
```

### Ручная установка

1. Подключитесь к роутеру по SSH:
```
ssh root@192.168.1.1
```

2. Установите необходимые пакеты:
```
opkg update
opkg install wget curl xray-core luci-app-xray uhttpd uhttpd-mod-ubus openvpn-openssl luci-app-openvpn
```

3. Создайте необходимые директории:
```
mkdir -p /root/vless-router/scripts
mkdir -p /root/vless-router/web
mkdir -p /root/vless-router/config
mkdir -p /etc/vless-router
```

4. Скопируйте файлы с этого репозитория на роутер:
```
scp -r scripts/* root@192.168.1.1:/root/vless-router/scripts/
scp -r web/* root@192.168.1.1:/root/vless-router/web/
scp -r config/* root@192.168.1.1:/root/vless-router/config/
scp vless_profile.md root@192.168.1.1:/root/
```

5. Установите права на выполнение скриптов:
```
chmod +x /root/vless-router/scripts/*.sh
```

6. Запустите установочный скрипт:
```
/root/vless-router/scripts/setup.sh
```

## Использование

### Веб-интерфейс

После установки веб-интерфейс доступен по адресу `http://192.168.1.1:8080`. Через веб-интерфейс можно:

1. Включать/выключать проксирование трафика
2. Управлять профилями VLESS
3. Настраивать белый и черный списки сайтов
4. Настраивать WiFi сети
5. Экспортировать/импортировать настройки

### WiFi сети

По умолчанию создаются две WiFi сети:
- `VLESS_DIRECT` - обычная сеть без проксирования
- `VLESS_PROXY` - сеть, в которой весь трафик проксируется через VLESS

Вы можете изменить названия и пароли этих сетей через веб-интерфейс.

### Командная строка

Для управления сервисом VLESS из командной строки используйте следующие команды:

```
# Запуск сервиса
/root/vless-router/scripts/vless-service.sh start

# Остановка сервиса
/root/vless-router/scripts/vless-service.sh stop

# Перезапуск сервиса
/root/vless-router/scripts/vless-service.sh restart

# Переключение профиля
/root/vless-router/scripts/vless-service.sh switch_profile "имя_профиля"
```

## Структура проекта

```
vless-router/
├── scripts/
│   ├── setup.sh           - Установочный скрипт
│   └── vless-service.sh   - Скрипт управления сервисом
├── web/
│   ├── css/               - CSS стили веб-интерфейса
│   ├── js/                - JavaScript файлы веб-интерфейса
│   ├── index.html         - Главная страница веб-интерфейса
│   └── api.php            - API бэкенд для веб-интерфейса
├── config/
│   ├── xray.json          - Шаблон конфигурации Xray
│   ├── settings.json      - Настройки сервиса
│   └── profiles.json      - Профили VLESS
└── README.md              - Документация
```

## Настройка перед первым использованием

1. Подключитесь к веб-интерфейсу по адресу `http://192.168.1.1:8080`
2. Перейдите во вкладку "Профили" и добавьте VLESS профили (или убедитесь, что они уже добавлены)
3. Перейдите во вкладку "WiFi" и настройте названия сетей и пароли
4. Перейдите во вкладку "Настройки" и выберите режим проксирования
5. Включите прокси с помощью переключателя на главной странице

## Проблемы и решения

### Не работает проксирование

1. Убедитесь, что сервис VLESS запущен
2. Проверьте, что профиль VLESS активен и валиден
3. Проверьте настройки маршрутизации в веб-интерфейсе
4. Перезапустите сервис или перезагрузите роутер

### Медленное соединение

1. Попробуйте выбрать другой профиль VLESS с сервером, который географически ближе к вам
2. Используйте режим выборочного проксирования вместо проксирования всего трафика

## Поддержка

Если у вас возникли проблемы с установкой или использованием, создайте issue в этом репозитории.

## Лицензия

MIT
